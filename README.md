# Analyses performed for "Early leukocyte responses in ex-vivo models of healing and non-healing human Leishmania (Viannia) panamensis infections."

This directory is intended to provide further details on the methods
employed when analyzing/visualizing this dataset.  The general
goal of the experiments were to compare the responses of macrophages
and PBMCs in response to a few different strains of Leishmania
panamensis.  There were some peculiarities in the data which caused us
to explore many avenues of analysis before finally bringing together
these two experiments.

In all cases, there was one primary conditional query of interest:
what is the difference in response between the uninfected PBMC or
Macrophages vs. those which were infected with a self-healing or
chronic disease causing strain of panamensis.  To that end, 8 strains
were used; these strains displayed some very interesting/peculiar
patterns when further explored, which caused us to do quite a lot of
playing with different ways of examining surrogate variables in the
data.

# Running the markdown

The most likely way one will interact with these documents is to open
the .Rmd files in an IDE like Rstudio and use the 'knit' button.  For
my own purposes, I use emacs with ESS and the 'render-html' function;
but the results should be identical as long as you have the
prerequisites installed:

* [https://github.com/abelew/hpgltools](hpgltools): The installation
  of this will pull in most/all of the prerequisites from bioconductor
  for the various analyses performed.
* [https://github.com/abelew/EuPathDB](EuPathDB): If you wish to play
  with kinetoplastid annotations from tritrypdb.org, then this should
  make your life easier.
  
If you wish to go for maximum reproducibility, make note of the git
commit ID at the bottom of the html documents so that you can get the
exact codebase which was used when generating the html.

# Organization

This top level directory contains two R markdown worksheets: one each
for the macrophage and PBMC experiments.  In each case I included the
most recent significantly changed version of each analysis,
'macrophage_all_analyses_202007.Rmd' and
'pbmc_all_analyses_202102.Rmd'.  When these documents were rendered,
they created dated versions of their html outputs, these were also
included in the top level directory.

The sample_sheets/ directory contains a sample sheet which includes
all samples from both experiments.  The preprocessing/ directory contains the
count tables from tophat/hisat/salmon.  Due to size constraints, I did
not include the actual fastq files, alignments, etc. which were
performed on our computing cluster.  These are trivially available.  I
did include the shell scripts which were generated by CYOA for the
preprocessing tasks; there is one important caveat though -- in the
midst of working with these samples our cluster migrated from Torque
to Slurm, and so some of the automatically generated scripts are
specific to each cluster (this is one way you can trivially see the
different times we worked with the data).  In addition, later
revisions of CYOA added suffixes to the submission scripts to make
explicit the species/strain used as well as some parameters for
mapping/counting/etc.  Thus if the reader decides to look, one will
find multiple scripts for each task performed because I decided to
include them all (well, not so much decided as I am too lazy to go
through and delete the old ones).

# Documents

## macrophage_all_analyses_202007 last run in January 2021

In preparation for making a new release of the repository, I am
rerunning [this document](macrophage_all_analyses_202007.Rmd) in the
hopes of assuring to myself that I included all of the count tables
etc required for it.  Everything passed and looked pretty good to me,
so I guess this section should actually be named 'last run in June
2021'.

These analyses sought to compare 3 groups of macrophages.  One which
was uninfected, one which was infected with a few strains of
L.panamensis which are known to lead to a chronic infection, and one
group infected with strains leading to a self-healing infection.
Unfortunately, the data is a bit sparser than I would like -- I think
it could have been awesome with more.

### Notes

I did disable the generation of the EuPathDB annotation databases.  A
few months ago I changed that code to add the database revision to the
databases and I do not think this code takes that into account so it
started to redownload all the data from tritrypdb.org, which is
annoying.

## pbmc_all_analyses_202102 last run in March 2021

This document is a bit more unwieldy than the macrophage.  We have the
same general experimental design with one big and interesting
difference: e.g. PBMCs were collected from three donors and infected
with the various self-healing and chronic strains.  I think this must
have been a tremendous amount of work in the lab, so in my mind it is
quite reasonable that we only have three donors, but once again I
think the data would have been so awesome with more.

I also ran this document in June to make sure moving it into a git
repository didn't inadvertently break something.

### Notes

Right at the top I see that in this file I made explicit the tritrypdb
revision.  That was way smarter; so I left the collection of the
eupathdb annotations in place.

One important caveat: two samples were considered for removal from this
because the strains which were used for the infection have since
proven to be weird/inconsistent.  I have some notes about what was
going on with them, but right now I cannot recall the details.  But
therefore, if one pays attention to this worksheet, one will see that
the sample sheet is explicitly named 'pbmc_samples_removetwo' for this
reason. 


[![DOI](https://zenodo.org/badge/323398486.svg)](https://zenodo.org/badge/latestdoi/323398486)





